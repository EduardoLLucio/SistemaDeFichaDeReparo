
.modal-ficha {
  .modal-overlay {
    position: fixed;
    inset: 0;
    background: rgba(0,0,0,.5);
    display: flex;
    align-items: center;
    justify-content: center;
    z-index: 3000;
    padding: 0;
  }

  .modal-content {
    background: #fff;
    border-radius: 12px;
    padding: 1.25rem;
    padding-bottom: 5.5rem;;
    box-shadow: 0 10px 30px rgba(0,0,0,.20);
    width: 1200px;
    max-width: calc(100vw - 48px);
    max-height: calc(100vh - 48px);
    display: flex;
    flex-direction: column;
    box-sizing: border-box;
    overflow: auto;
    position: relative;
  }

  .modal-title {
    margin: 0 0 .5rem 0;
    font-size: 1.25rem;
    font-weight: 700;
    color: #0f172a;
  }

  /* layout principal */
  .modal-form .modal-grid-row {
    display: flex;
    gap: 20px;
    align-items: flex-start;
    width: 100%;
    box-sizing: border-box;
  }

  /* coluna esquerda */
  .modal-left {
    flex: 0 0 320px;
    min-width: 260px;
    box-sizing: border-box;
  }

  .modal-left .form-grid {
    display: grid;
    grid-template-columns: 1fr;
    gap: 12px;
  }

  .modal-left .form-grid input,
  .modal-left .form-grid select,
  .modal-left .form-grid textarea {
    width: 100%;
    box-sizing: border-box;
  }

  .modal-left label {
    font-size: .9rem;
    color: #6b7280;
    margin: .18rem 0 .12rem;
    display: block;
  }

  .modal-left input,
  .modal-left select,
  .modal-left textarea {
    padding: .6rem .8rem;
    border-radius: 8px;
    border: 1px solid #d1d5db;
    background: #fff;
    color: #111827;
    font-size: .95rem;
    box-sizing: border-box;
  }

  .modal-right {
    flex: 1 1 auto;
    min-width: 0;
    display: grid;
    grid-template-columns: minmax(360px, 1fr) 320px;
    grid-auto-rows: auto;
    gap: 18px;
    padding-left: 8px;
    box-sizing: border-box;
    align-items: start;
  }

  .right-section {
    display: flex;
    flex-direction: column;
    gap: 10px;
    min-width: 0;
  }

  .modal-right .right-section:nth-child(1) { grid-column: 1; grid-row: 1; }
  .modal-right .right-section:nth-child(2) { grid-column: 1; grid-row: 2; }
  .modal-right .right-section:nth-child(3) { grid-column: 2; grid-row: 1 / span 2; align-self: start; }

  /* cartões de dados */
  .dados-atuais,
  .dados-ficha {
    background: #fff;
    border: 1px solid #eef2f7;
    padding: 12px;
    border-radius: 8px;
    box-shadow: 0 2px 6px rgba(16,24,40,0.03);
    color: #111827;
    box-sizing: border-box;
    width: 100%;
  }

  /* linhas internas: label fixo + valor flexível */
  .dados-atuais > div,
  .dados-ficha .ficha-row {
    display: grid;
    grid-template-columns: 120px minmax(120px, 1fr);
    gap: 8px;
    align-items: start;
    margin-bottom: 6px;
  }

  .dados-atuais .k,
  .ficha-label {
    color: #374151;
    font-weight: 700;
    font-size: 0.9rem;
    white-space: nowrap;
    text-align: left;
  }

  .dados-atuais .v,
  .ficha-val {
    color: #111827;
    font-weight: 600;
    font-size: 0.9rem;
    white-space: normal;
    word-break: break-word;
    overflow-wrap: anywhere;
  }

  /* histórico com scroll e espaço para footer */
  .history-list {
    list-style: none;
    padding: 8px;
    margin: 0;
    max-height: calc(80vh - 240px);
    overflow-y: auto;
    border-radius: 8px;
    border: 1px solid #e5e7eb;
    background: #ffffff;
    width: 100%;
    box-sizing: border-box;
    padding-bottom: 96px; 
  }

  .history-item {
    padding: 8px;
    border-radius: 6px;
    background: transparent;
    margin-bottom: 8px;
    font-size: .88rem;
  }
  .history-date { font-weight: 600; font-size: .85rem; color: #374151; }
  .history-text { color: #374151; font-size: .9rem; margin-top: 4px; }

  /* footer / botões */
  .modal-footer,
  .modal-actions {
    order: 99;
    flex-basis: 100%;
    display: flex;
    justify-content: flex-end;
    gap: 12px;
    margin-top: 12px;
    padding-top: 8px;
    box-sizing: border-box;
    position: relative;
    z-index: 100;
    background: transparent;
  }

  .btn {
    padding: .55rem .9rem;
    border-radius: 8px;
    border: 1px solid transparent;
    cursor: pointer;
    font-weight: 600;
    min-width: 96px;
    box-sizing: border-box;
  }
  .btn.primary { background: #2563eb; color: #fff; border-color: #2563eb; }
  .btn.secondary { background: #fff; color: #1f2937; border: 1px solid #e5e7eb; }

  .modal-footer {
    position: absolute;
    left: 1.25rem;
    bottom: 16px;
    width: calc(320px - 1.25rem);
    max-width: 45%;
    display: flex;
    justify-content: flex-start;
    gap: 8px;
    padding: 0;
    z-index: 5000;
    background: transparent;
    box-shadow: none;
  }

  .modal-footer .btn {
    min-width: 84px;
    padding: .4rem .75rem;
  }

  .modal-content .modal-form .modal-grid-row > .modal-left .form-grid {
    display: grid;
    grid-template-columns: 1fr;
    gap: 12px;
  }

  .modal-content .modal-form .modal-grid-row > aside.modal-right {
    display: grid;
    grid-template-columns: minmax(360px, 1fr) 320px;
    gap: 18px;
  }

  /* responsivo */
  @media (max-width: 980px) {
    .modal-content { width: 96vw; max-height: 92vh; padding: 1rem; height: auto; }
    .modal-form .modal-grid-row { flex-direction: column; gap: 12px; }
    .modal-left { width: 100%; flex: 1 1 auto; min-width: 0; }
    .modal-right { display: flex; flex-direction: column; width: 100%; padding-left: 0; }
    .modal-right .right-section:nth-child(1),
    .modal-right .right-section:nth-child(2),
    .modal-right .right-section:nth-child(3) { grid-column: auto; grid-row: auto; width: 100%; }
    .history-list { max-height: 260px; width: 100%; padding-bottom: 24px; }
    .modal-footer { position: static; width: 100%; bottom: auto; left: auto; justify-content: center; margin-top: 12px; }
  }
}

